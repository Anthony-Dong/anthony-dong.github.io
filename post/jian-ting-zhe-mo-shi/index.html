<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="shortcut icon"href="https://anthony-dong.github.io/favicon.ico"type="image/x-icon"/><meta name="viewport"content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/><meta name="apple-mobile-web-app-capable"content="yes"/><meta name="apple-mobile-web-app-status-bar-style"content="black"/><meta name="format-detection"content="telephone=no"/><meta name="renderer"content="webkit"/><meta name="description"content="Anthony-Dongçš„ä¸ªäººåšå®¢"/><meta charset="UTF-8"/><title>è®¾è®¡æ¨¡å¼ - äº‹ä»¶ç›‘å¬è€…æ¨¡å¼ - JDK &amp; Spring &amp; Guava å„æœ‰åƒç§‹ | Anthony-Dong</title><link href="https://anthony-dong.github.io/styles/main.css"type="text/css"rel="stylesheet"/><script src="https://anthony-dong.github.io/media/js/magnify.min.js"></script>
	<link rel="canonical" href="https://anthony-dong.github.io/post/jian-ting-zhe-mo-shi/" />
</head>
<body>
	<div class="progress"></div><style>.progress{background:linear-gradient(to right,#87ceeb var(--scroll),transparent 0);background-repeat:no-repeat;position:fixed;width:100%;height:4px;z-index:1}</style><div class="darkmode-background"></div><div class="darkmode-layer"></div>
<noscript><p class="warn" >æœ¬é¡µé¢éœ€è¦æµè§ˆå™¨æ”¯æŒï¼ˆå¯ç”¨ï¼‰JavaScript</p></noscript><div class="header"><div class="logo_title"><div class="title animated fadeInDown"><a href="https://anthony-dong.github.io"><img alt="logo" style="display:inline-block;" src="https://anthony-dong.github.io/images/avatar.png"/></a><h1 title="Anthony-Dong" class="weaklink shift"><a  href="/">Anthony-Dong</a></h1>

<div class="navbar weaklink">
<div class="normal_nav">
<div class="bitcron_nav_container"><div class="bitcron_nav"><div class="bitcron_nav"><div style="display:flex;justify-content:center;"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/link" class="selected active current nav__item" >å‹é“¾</a></li></ul></nav>
<div style="float:right;margin-top:1em"><form id="gridea-search-form" data-update="1578893743252" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="Search..."></form></div>
<div style="margin-left:0.5em;margin-top:1.2em"><input id="switch_default" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
<div class="clear clear_nav_inline_end"></div></div></div><div class="clear clear_nav_end"></div></div></div><div class="hamberger" href="javascript:void(0)" onclick="btn_toggle();"><i class="iconfont icon-category"></i></div></div></div></div>
<div id="hn" class="no-js hidden_nav animated fadeInDown"><div class="bitcron_nav_container"><div class="bitcron_nav"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/link" class="selected active current nav__item" >å‹é“¾</a></li></ul><div class="clear clear_nav_inline_end"></div></nav></div><div class="clear clear_nav_end"></div></div>
<div style="display:flex;justify-content:center;inline-block;text-align:center;margin-top:7%"><div><form id="gridea-search-form-1" data-update="1614223342286" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q"  placeholder="Search..." /></form></div><div style="margin-left:0.5em"><input id="switch_default_h" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
</div></div>
<script>function enableDarkmode(){document.body.classList.add("darkmode"),document.getElementById("switch_default").checked=1,document.getElementById("switch_default_h").checked=1}function removeDarkmode(){document.body.classList.remove("darkmode"),document.getElementById("switch_default").checked=0,document.getElementById("switch_default_h").checked=0}function getCookie(a){var b,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)");return(b=document.cookie.match(c))?unescape(b[2]):null}cookie=getCookie("darkmode"),"enable"==cookie&&enableDarkmode(),window.matchMedia("(prefers-color-scheme: dark)").matches&&"disable"!==cookie&&(enableDarkmode(),document.cookie="darkmode=enable; path=/");var mobileBtn=function(){1==document.getElementById("switch_default").checked?(enableDarkmode(),document.cookie="darkmode=enable; path=/"):(removeDarkmode(),document.cookie="darkmode=disable; path=/")};</script>

	<div class="main">
		<div class="main-inner">
			<div class="content">
				<article class="post">
					<script src='https://anthony-dong.github.io/media/js/Valine.min.js'></script><style>.v .vlist .vcard .vh .vmeta .vat{font-size:.8125em;color:#9d7873;cursor:pointer;float:right}.v .vlist .vcard .vhead .vsys{display:none}</style ><script type="text/javascript">new Valine(ValineInfo)</script>
					<h2 class="post_title sm_margin"><a>è®¾è®¡æ¨¡å¼ - äº‹ä»¶ç›‘å¬è€…æ¨¡å¼ - JDK &amp; Spring &amp; Guava å„æœ‰åƒç§‹</a></h2>
					<script>
						function lan() {
							if (document.getElementById("lan").innerText == "ç¹") {
								var s = document.getElementById("tongwenlet_cn");
								if (s != null) {
									document.body.removeChild(s)
								}
								var s = document.createElement("script");
								s.language = "javascript";
								s.type = "text/javascript";
								s.src = "https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_tw.js";
								s.id = "tongwenlet_cn";
								document.body.appendChild(s);
								document.getElementById("lan").innerHTML = "ç®€"
							} else {
								if (document.getElementById("lan").innerText == "ç°¡") {
									var s = document.getElementById("tongwenlet_cn");
									if (s != null) {
										document.body.removeChild(s)
									}
									var s = document.createElement("script");
									s.language = "javascript";
									s.type = "text/javascript";
									s.src = "https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_cn.js";
									s.id = "tongwenlet_cn";
									document.body.appendChild(s);
									document.getElementById("lan").innerHTML = "ç¹"
								}
							}
						};
					</script>
					<section class="post_details"><i class="iconfont icon-calendar"></i><span style="margin-right:15px">
							2019-11-09</span><i class="iconfont icon-browse"></i>
							<span class="leancloud_visitors" style="margin-right:15px" id="/post/jian-ting-zhe-mo-shi/">views <i class="leancloud-visitors-count" style="font-style: normal"></i></span>
							<span class="weaklink" style="margin-right:15px"><i class="iconfont icon-category"></i> <a
								href="https://anthony-dong.github.io/tag/Vyew36Twpl/"
								class="tag">JavaåŸºç¡€</a> |
							 <a
								href="https://anthony-dong.github.io/tag/30KjDURvPf/"
								class="tag">spring</a> |
							 <a
								href="https://anthony-dong.github.io/tag/hWcBwQyHp2o/"
								class="tag">è®¾è®¡æ¨¡å¼</a></span><i class="iconfont icon-caret-down"></i><span
							style="margin-right:15px">3750å­—</span><i
							class="iconfont icon-naozhong"></i><span
							style="margin-right:15px">17 min read</span><a id="lan"
							href="javascript:void(0);" onclick="lan();" title="è°ƒæ•´ç®€ç¹ä½“" style="margin-right:15px;">ç¹</a>
						</section>

						<div style="display:flex">
							<div class="md_block" id="md_block">
								<div class="round-shape-one"></div>
								<blockquote>
<p>â€‹	ä½•ä¸ºäº‹ä»¶ç›‘å¬è€…æ¨¡å¼ ?</p>
<p>â€‹	ç¬¬ä¸€å°±æ˜¯ä¸ºå•¥æˆ‘å¼ºè°ƒäº‹ä»¶äºŒå­— ,å› ä¸ºä»–æ˜¯ç›®æ ‡ . åœ¨æˆ‘ä»¬å¼€å‘ä¸­ç»å¯¹è§åˆ°è¿‡ä¸€å †åç¼€æ˜¯ <code>Listener</code>çš„ç±», è¿™ä¸ªå°±æ˜¯ç›‘å¬è€…æ¨¡å¼, ç›‘å¬è€…æ¨¡å¼æ˜¯ä¸€ç§<code>CSå¼€å‘æ¶æ„</code>,å¾ˆå¥½çš„åšäº†ä¸€ç§è®¾è®¡çš„è§£è€¦,ç›‘å¬è€…æ³¨å†Œåˆ°ä¸€ä¸ªé‚®å±€ä¸­,è®¢é˜…æŸç§äº‹ä»¶(æå‰è¯´å¥½äº†), é‚®å±€ä¼šæŒ‰éœ€æ±‚å‘å¸ƒæ¶ˆæ¯, ç›‘å¬è€…ä¼šåŠæ—¶æ”¶åˆ°æ¶ˆæ¯æ¥å¤„ç† . å…¶ä¸­æ•´ä¸ªJavaå¼€å‘ç¯å¢ƒä¸­ , JDKå·²ç»å¸®æˆ‘ä»¬å®šä¹‰å¥½äº†æ¥å£ , Springå°±æ˜¯åŸºäºJDKæ¥å£ä¸‹å®ç°çš„, Guavaåˆ™æ˜¯å¦ä¸€ç§å®ç°æ–¹å¼, å„æœ‰åƒç§‹ , å¤§å®¶çœ‹çœ‹å§ , åˆ°åº•æ˜¯å›è°ƒå¥½è¿˜æ˜¯é˜»å¡, è¿˜æ˜¯Guavaè¿™ç§æ–¹å¼å‘¢,<br>
ä»–å’Œè§‚å¯Ÿè€…æ¨¡å¼æœ‰ä½•åŒºåˆ«å‘¢ ? æˆ‘ä»¬æœ‰æœºä¼šåœ¨è®²</p>
</blockquote>
<h2 id="1-javaåŸç”Ÿè§„èŒƒ">1. JavaåŸç”Ÿè§„èŒƒ</h2>
<h3 id="1-eventobject">1. EventObject</h3>
<blockquote>
<p>â€‹	<strong>äº‹ä»¶å¯¹è±¡ , ä»–éœ€è¦ä¸€ä¸ªäº‹ä»¶æº , ç”¨æ„é€ å‡½æ•°ä¼ é€’çš„</strong></p>
</blockquote>
<pre><code class="language-java">public class EventObject implements java.io.Serializable {
    protected transient Object  source;

    public EventObject(Object source) {
        if (source == null)
            throw new IllegalArgumentException(&quot;null source&quot;);

        this.source = source;
    }
    ........... å…¶ä»–çœç•¥ 
}
</code></pre>
<h3 id="2-eventlistener">2. EventListener</h3>
<blockquote>
<p>â€‹	<strong>äº‹ä»¶ç›‘å¬è€…,ä»–æ˜¯è´Ÿè´£ç›‘å¬äº‹ä»¶çš„ , JAVAæä¾›çš„æ˜¯ä¸€ä¸ªç©ºæ¥å£, è®©æˆ‘ä»¬æ ¹ç»éœ€æ±‚å†™</strong></p>
</blockquote>
<pre><code class="language-java">public interface EventListener {
}
</code></pre>
<h3 id="3-æ€»ç»“">3. æ€»ç»“</h3>
<p>æˆ‘ä»¬å‘ç° java æä¾›çš„åªæä¾›äº†ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ ,å’Œä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨  ,æ‰€ä»¥éœ€è¦æˆ‘ä»¬éµå®ˆè¿™ä¸ªè§„èŒƒå»å¼€å‘</p>
<h2 id="2-javaè§„èŒƒè®¾è®¡ä¸€ä¸ªç›‘å¬è€…æ¨¡å¼-åŸºäºå›è°ƒæ¨¡å¼">2. Javaè§„èŒƒè®¾è®¡ä¸€ä¸ªç›‘å¬è€…æ¨¡å¼ - åŸºäºå›è°ƒæ¨¡å¼</h2>
<h3 id="1-äº‹ä»¶æº-eventsource">1. äº‹ä»¶æº - EventSource</h3>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ éƒ½ä¼šè®¾ç½®æˆä¸€ä¸ª Object ç±»å‹çš„ , ä¸éœ€è¦æˆ‘ä»¬å»è®¾è®¡ä¸€ä¸ª,ä¸ºäº†ä½“ç°è®¾è®¡æ¨¡å¼çš„è§’è‰²,æˆ‘ä»¬å°±è®¾è®¡äº†ä¸€ä¸ª</p>
<pre><code class="language-java">@ToString
@Setter
@Getter
public class EventSource {
    private String name;
    private String info;
}
</code></pre>
<h3 id="2-äº‹ä»¶å¯¹è±¡-eventobject">2. äº‹ä»¶å¯¹è±¡ - EventObject</h3>
<p>è¿™é‡Œæˆ‘ä»¬ç»§æ‰¿äº† EventObject , åªæ˜¯ç®€å•çš„å®ç°äº†ä¸€ä¸‹ , å¹¶æ²¡æœ‰åšè¿‡å¤šçš„åŒ…è£…</p>
<pre><code class="language-java">public class CoreEventObject extends EventObject {
    public CoreEventObject(EventSource source) {
        super(source);
    }
}
</code></pre>
<h3 id="3-äº‹ä»¶ç›‘å¬è€…-eventlistener">3. äº‹ä»¶ç›‘å¬è€… - EventListener</h3>
<p>è¿™é‡Œæˆ‘ä»¬çœŸæ­£çš„ç›‘å¬è€… , ä¸€èˆ¬æƒ…å†µä¸‹éƒ½éœ€è¦è®¾è®¡æˆä¸€ä¸ª å‡½æ•°å¼æ¥å£ , æˆ‘è¿™ä¸ªæ˜¯å’ŒSpringæ¡†æ¶å­¦ä¹ çš„ , å› ä¸ºå‡½æ•°å¼æ¥å£æ‰èƒ½ä½“ç°å›è°ƒ ,</p>
<pre><code class="language-java">@FunctionalInterface
public interface CoreEventListener&lt;E extends CoreEventObject&gt; extends EventListener {

    void onEventObject(E event);
}
</code></pre>
<h3 id="4-äº‹ä»¶å‘å¸ƒè€…-eventpublisher">4. äº‹ä»¶å‘å¸ƒè€… -  EventPublisher</h3>
<p>äº‹ä»¶å‘å¸ƒè€… ,å› ä¸ºæ²¡æœ‰å‘å¸ƒçš„äº‹ä»¶å¯¹è±¡, å“ªæ¥çš„ç›‘å¬</p>
<pre><code class="language-java">public class EventPublisher&lt;E extends CoreEventObject&gt; {

    private CoreEventListener&lt;E&gt; listener;


    public EventPublisher(CoreEventListener&lt;E&gt; listener) {
        this.listener = listener;
    }

    
    public void publish(E object){
        System.out.println(&quot;å‘å¸ƒäº‹ä»¶ : &quot; + object);
        // ä¼ ç»™ CoreEventListener
        listener.onEventObject(object);
    }
}
</code></pre>
<h3 id="5-æµ‹è¯•demo">5. æµ‹è¯•Demo</h3>
<pre><code class="language-java">public class TestDemo {
    public static void main(String[] args) {
        // 1. åˆ›å»ºä¸€ä¸ªäº‹ä»¶å‘å¸ƒè€…
        EventPublisher&lt;CoreEventObject&gt; publisher = new EventPublisher&lt;&gt;(new CoreEventListener&lt;CoreEventObject&gt;() {
            @Override
            public void onEventObject(CoreEventObject event) {
                System.out.println(&quot;æ¥æ”¶åˆ°äº‹ä»¶æº : &quot; + event.getSource() + &quot; , å½“å‰çº¿ç¨‹ : &quot; + Thread.currentThread().getName()); 
            }
        });

        // 2. å‘å¸ƒä¸€ä¸ªäº‹ä»¶å¯¹è±¡ 
        publisher.publish(getCoreEventObject());
    }

    private static CoreEventObject getCoreEventObject(){
        ..... æ­¤å¤„çœç•¥ 
        return eventObject;
    }
}
</code></pre>
<p>è¾“å‡ºç»“æœ :</p>
<pre><code class="language-java">å‘å¸ƒäº‹ä»¶ : com.example.listener_design_pattern.CoreEventObject[source=EventSource(name=äº‹ä»¶æº, info=Sat Nov 09 14:34:50 CST 2019)]
æ¥æ”¶åˆ°äº‹ä»¶æº : EventSource(name=äº‹ä»¶æº, info=Sat Nov 09 14:34:50 CST 2019) , å½“å‰çº¿ç¨‹ : main
</code></pre>
<p>æˆ‘ä»¬å‘ç°æˆ‘ä»¬æˆåŠŸçš„æ¥æ”¶åˆ°äº†äº‹ä»¶å¯¹è±¡ å’Œ äº‹ä»¶æº , è¿™ä¸ªå°±æ˜¯é’©å­å‡½æ•°çš„é­…åŠ› . å…¶å®ä½ åªæ˜¯åšäº†ä¸€ä¸ªäº‹ä»¶å‘å¸ƒä½ æ— å¿ƒè§‚å¯Ÿå…¶ä»–çš„ä¸œè¥¿ , åªéœ€è¦ä¸€ä¸ªç›‘å¬è€…å°±å¯ä»¥åšåˆ°ç›‘å¬äº† , è¿™æ ·ä½ çš„äº‹ä»¶å‘å¸ƒ å’Œ ç›‘å¬ å®Œå…¨å°±è§£è€¦äº† .å…¶å®åº•å±‚å°±æ˜¯ä¸€ä¸ªåœ°å€å¼•ç”¨ .</p>
<h2 id="3-å›è°ƒå‡½æ•°å­˜åœ¨çš„é—®é¢˜">3. å›è°ƒå‡½æ•°å­˜åœ¨çš„é—®é¢˜ ?</h2>
<h3 id="1-æˆ‘ä»¬çš„é—®é¢˜">1. æˆ‘ä»¬çš„é—®é¢˜ ?</h3>
<p>å¾ˆå¤šåœºæ™¯ä¸‹,æˆ‘ä»¬çš„å‘å¸ƒäº‹ä»¶å’Œç›‘å¬äº‹ä»¶å®Œå…¨åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¸­,é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ‹¿åˆ°äº‹ä»¶å¯¹è±¡å‘¢ ?</p>
<p>å¦‚æœæˆ‘ä»¬ç®€å•ä½¿ç”¨ä¸€ä¸‹ , ä¼šè¿™ä¹ˆå†™ ?</p>
<pre><code class="language-java">public class TestEventListener implements CoreEventListener&lt;CoreEventObject&gt; {

    private CoreEventObject object;

    @Override
    public void onEventObject(CoreEventObject object) {
 		// èµ‹å€¼ç»™æˆå‘˜å˜é‡ 
        this.object = object;
    }

    // è·å–æˆå‘˜å˜é‡ 
    public CoreEventObject getObject() {
        return object;
    }
}
</code></pre>
<p>æµ‹è¯•ä¸€ä¸‹ :</p>
<pre><code class="language-java">public class TestDemo {

    public static void main(String[] args) {

        TestEventListener listener = new TestEventListener();
        CoreEventObject object = listener.getObject();
        // å…ˆå»æ‹¿ ,åå»å‘å¸ƒ
        System.out.println(object.getSource());

        EventPublisher&lt;CoreEventObject&gt; publisher = new EventPublisher&lt;&gt;(listener);
        publisher.publish(getCoreEventObject());
    }


    private static CoreEventObject getCoreEventObject(){
			.... 
        return eventObject;
    }

}

</code></pre>
<p>è¾“å‡ºç»“æœ</p>
<pre><code class="language-java">Exception in thread &quot;main&quot; java.lang.NullPointerException
	at com.example.listener_design_pattern.TestDemo.main(TestDemo.java:28)
</code></pre>
<p>æœ‰äº›äººå°±ä¼šè¯´ , ä½ è¿™ä¸å¯¹å“‡ ,ä½ å½“ç„¶æ‹¿ä¸åˆ°äº† ,å› ä¸ºäººå®¶è¿˜æ²¡å‘å¸ƒäº† ,ä½†æ˜¯åœ¨å¤šçº¿ç¨‹ ,åœ¨è§£è€¦çš„æƒ…å†µä¸‹ ,ä½ å“ªçŸ¥é“å¯¹é¢ä½•æ—¶å‘å¸ƒç»“æŸäº† , ä½ å†å»æ‹¿å‘¢ ? é‚£å°±éœ€è¦javaçš„å¤šçº¿ç¨‹çŸ¥è¯†äº† ,Future ç»™æˆ‘ä»¬å¸¦æ¥äº†æé†’ , å°±æ˜¯é˜»å¡çš„æ€æƒ³ , åªæœ‰ç›‘å¬è€…çœŸæ­£çš„æ”¶åˆ°å¯¹è±¡ , æˆ‘ä»¬æ‰èƒ½å»æ‹¿ .</p>
<h3 id="2-è§£å†³é—®é¢˜">2. è§£å†³é—®é¢˜</h3>
<p>äº†è§£è¿‡æˆ‘å‰é¢æåˆ°çš„é‚£ä¸€èŠ‚ <code>FutureTask</code>æ˜¯å¦‚ä½•å®ç°çš„ ,æˆ‘è§‰å¾—é—®é¢˜å°±è¿åˆƒè€Œè§£äº† .</p>
<pre><code class="language-java">public class TestEventListener implements CoreEventListener&lt;CoreEventObject&gt; {
    private CoreEventObject object;

    /**
     * å½“ X = 0 ,ä»£è¡¨ objè¿˜æ²¡æœ‰åˆå§‹åŒ–äº†
     * å½“ x = 1 , ä»£è¡¨ obj ä»¥åŠåˆå§‹åŒ–äº† , å·²ç»æ¥æ”¶åˆ°äº†
     */
    private static volatile int x = 0;

    @Override
    public void onEventObject(CoreEventObject object) {
        this.object = object;
        // æ”¶åˆ°æ”¹æˆ 1
        x = 1;
    }

    public CoreEventObject getObject() {
        while (true) {
            if (x == 1) {
                break;
            }
        }
        // æ‹¿åˆ°å¯¹è±¡,å†è®¾ç½®ä¸º1
        x = 0;
        return object;
    }
}
</code></pre>
<p>ç”±äºè¿™ä¸ªè§£å†³æ–¹æ¡ˆ,ä¼šä½¿å¾—æ‰§è¡Œ<code>getObject()</code> çš„çº¿ç¨‹ä¸€ç›´çš„é˜»å¡ä¸‹å»,å°±æ˜¯æ­»å¾ªç¯ä¸‹å»,æˆ‘ä»¬å¿…é¡»ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªæ–¹æ³• ,</p>
<pre><code class="language-java">public class TestDemo {
    public static void main(String[] args) {
        TestEventListener listener = new TestEventListener();
        // æ–°å»ºä¸€ä¸ªçº¿ç¨‹å»æ¥æ”¶
        Thread thread = new Thread(() -&gt; {
            System.out.println(&quot;æˆ‘å¼€å§‹æ¥æ”¶å¯¹è±¡ : &quot; + System.currentTimeMillis());
            CoreEventObject object = listener.getObject();
            System.out.println(&quot;æˆåŠŸæ¥æ”¶å¯¹è±¡ : &quot;+object.getSource());
        });
        thread.start();
		// æ–°å»ºä¸€ä¸ªçº¿ç¨‹å»å‘å¸ƒ
        EventPublisher&lt;CoreEventObject&gt; publisher = new EventPublisher&lt;&gt;(listener);
        new Thread(()-&gt;{
            publisher.publish(getCoreEventObject());
        }).start();
    }

    private static CoreEventObject getCoreEventObject(){
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        EventSource source = new EventSource();
        source.setName(&quot;äº‹ä»¶æº&quot;);
        source.setInfo(&quot;&quot; + System.currentTimeMillis());
        return new CoreEventObject(source);
    }
}
</code></pre>
<p>è¾“å‡ºç»“æœ :</p>
<pre><code class="language-java">æˆ‘å¼€å§‹æ¥æ”¶å¯¹è±¡ : 1573282924555
å‘å¸ƒäº‹ä»¶ : com.example.listener_design_pattern.CoreEventObject[source=EventSource(name=äº‹ä»¶æº, info=1573282925590)]
æˆåŠŸæ¥æ”¶å¯¹è±¡ : EventSource(name=äº‹ä»¶æº, info=1573282925590)
</code></pre>
<p>æˆ‘ä»¬æˆ‘ä»¬æ¥æ”¶çš„æ—¶å€™æ˜¯åœ¨1573282924555çš„æ—¶é—´æ“ , è€ŒçœŸæ­£æ‹¿åˆ°çš„å¯¹è±¡ç¡®å®åœ¨1573282925590å‘å¸ƒçš„ , è¿™ä¸ªå°±å®Œå…¨åœ¨ä¿©æ—¶é—´è½´ä¸Š,æ‰€ä»¥æˆ‘ä»¬æˆåŠŸçš„è§£å†³äº†é—®é¢˜ .</p>
<h2 id="4-spring-ä¸­çš„-applicationlistener">4. Spring ä¸­çš„ ApplicationListener</h2>
<h3 id="1-applicationevent">1. ApplicationEvent</h3>
<blockquote>
<p>â€‹	Class to be extended by all application events. Abstract as it doesn't make sense for generic events to be published directly.</p>
<p>â€‹	æ­¤ç±»è¢«æ‰€æœ‰çš„ <code>application events</code> æ‰€ç»§æ‰¿ ã€‚æŠ½è±¡çš„åŸå› æ˜¯å› ä¸ºç›´æ¥å‘å¸ƒè¿™ä¸ª<code>ApplicationEvent</code>æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚</p>
</blockquote>
<h3 id="2-applicationlistener">2. ApplicationListener</h3>
<blockquote>
<p>â€‹	Interface to be implemented by application event listeners. Based on the standard java.util.EventListener interface for the Observer design pattern.</p>
<p>â€‹	è¿™ä¸ªæ¥å£è¢«æ‰€æœ‰çš„ <code>application event listeners.</code>æ‰€å®ç° , åŸºäºJavaçš„ <code>java.util.EventListener</code>æ¥å£è§„èŒƒ</p>
</blockquote>
<h3 id="3-å¼€å§‹ä½¿ç”¨">3. å¼€å§‹ä½¿ç”¨</h3>
<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªéœ€æ±‚å°±æ˜¯ ,æˆ‘ä»¬æœ‰ä¸€ä¸ªæœåŠ¡ä¼šä»è¿œç¨‹ä¸æ–­çš„å»æ‹‰å»é…ç½®ä¿¡æ¯ ,ä¸€æ—¦æœ‰æ”¹å˜å°±ä¼šå‘å¸ƒé…ç½®ä¿¡æ¯ .</p>
<h4 id="1-config-äº‹ä»¶æº">1. Config - äº‹ä»¶æº</h4>
<pre><code class="language-java">@ToString
@Setter
@Getter
public class Config {
    private String namespace;
    private Map&lt;String, Object&gt; info;
}
</code></pre>
<h4 id="2-configevent-äº‹ä»¶å¯¹è±¡">2. ConfigEvent - äº‹ä»¶å¯¹è±¡</h4>
<pre><code class="language-java">// è¿™ä¸ªæ³¨è§£,æˆ‘ä»¬æ˜¯æ ¹æ®Springæºç çœ‹åˆ°çš„ , æ‰€ä»¥ä¸€è‡´æ€§,æˆ‘å°±åŠ äº†
@SuppressWarnings(&quot;serial&quot;)
public class ConfigEvent extends ApplicationEvent {

    public ConfigEvent(Config source) {
        super(source);
    }
}
</code></pre>
<h4 id="3-configeventlistener-äº‹ä»¶ç›‘å¬è€…">3. ConfigEventListener - äº‹ä»¶ç›‘å¬è€…</h4>
<pre><code class="language-java">@Component
public class ConfigEventListener implements ApplicationListener&lt;ConfigEvent&gt; , Ordered, InitializingBean {

    @Override
    public void onApplicationEvent(ConfigEvent event) {
        System.out.println(&quot;æ¥æ”¶åˆ°æ›´æ–°ä¿¡æ¯ : &quot; + event.getSource()+&quot; , å½“å‰çº¿ç¨‹ : &quot;+Thread.currentThread().getName());
    }
	// ä¿è¯æ‰§è¡Œé¡ºåº , å¤šä¸ª ConfigEventListenerå°±éœ€è¦å®ç°è¿™ä¸ªæ¥å£
    @Override
    public int getOrder() {
        return Ordered.HIGHEST_PRECEDENCE;
    }
	
    // åˆå§‹åŒ–ä»¥åè¦åšä»€ä¹ˆ ? 
    @Override
    public void afterPropertiesSet() throws Exception {
        System.out.println(&quot;åˆå§‹åŒ–å½“å‰ConfigEventListener&quot;);
    }
}
</code></pre>
<h4 id="5-configserver-é…ç½®ä¸­å¿ƒæœåŠ¡">5 . ConfigServer - é…ç½®ä¸­å¿ƒæœåŠ¡</h4>
<pre><code class="language-java">@Service
public class ConfigServer {
	
    // æ³¨å…¥applicationContext,å› ä¸ºåªæœ‰ä»–æ‰å¯ä»¥æ‰§è¡Œå‘å¸ƒäº‹ä»¶
    @Autowired
    private ApplicationContext applicationContext;

	// è¿™ä¸ªæ˜¯å¼€å¯å¼‚æ­¥ ,åé¢ä¼šè¯´åˆ°
    // @Async
    public void publishConfig(){
        // éœ€è¦å‘å¸ƒ --- &gt; æ”¹å˜çš„äº‹ä»¶
         System.out.println(&quot;å‘å¸ƒäº‹ä»¶æˆåŠŸ , å½“å‰çº¿ç¨‹ : &quot;+Thread.currentThread().getName());
        applicationContext.publishEvent(getChange());
    }
    
    
    public ConfigEvent getChange(){
        Config config = new Config();
        config.setNamespace(&quot;application&quot;);
        HashMap&lt;String, Object&gt; conf = new HashMap&lt;&gt;();
        conf.put(&quot;server.port&quot;, 8088);
        config.setInfo(conf);
        return  new ConfigEvent(config);
    }
}
</code></pre>
<h4 id="6-å¯åŠ¨æµ‹è¯•">6. å¯åŠ¨æµ‹è¯•</h4>
<pre><code class="language-java">@SpringBootApplication
public class SpringListenerApplication implements CommandLineRunner {

	public static void main(String[] args) {
		SpringApplication.run(SpringListenerApplication.class, args);
	}

	@Autowired
	private ConfigServer server;

	@Override
	public void run(String... args) throws Exception {
		server.publishConfig();
	}
}
</code></pre>
<p>è¾“å‡ºç»“æœ :</p>
<pre><code class="language-java">.....
åˆå§‹åŒ–å½“å‰ConfigEventListener
.... 
å‘å¸ƒäº‹ä»¶æˆåŠŸ , å½“å‰çº¿ç¨‹ : main
æ¥æ”¶åˆ°æ›´æ–°ä¿¡æ¯ : Config(namespace=application, info={server.port=8088}) , å½“å‰çº¿ç¨‹ : main
</code></pre>
<p>æ‰€ä»¥ä¸€ä¸ª<code>Spring-Boot</code>çš„äº‹ä»¶ç›‘å¬è¿˜æ˜¯å¾ˆç®€å•çš„  ,ç±»æ¯”åˆ° <code>Spring</code>ä¸€ä¸ªé“ç†,ç›¸ä¿¡æ‡‚å¾—äººéƒ½çŸ¥é“ . ä½†æ˜¯åˆä¸€ä¸ªé—®é¢˜æ˜¯æˆ‘ä»¬çš„ å‘å¸ƒå’Œç›‘å¬éƒ½æ˜¯ mainçº¿ç¨‹ ,ä¸å¥½å§ ,ç©æ„æœ‰å¾ˆå¤šäº‹ä»¶äº† ?</p>
<h3 id="4-å¼€å¯å¼‚æ­¥å‘å¸ƒ">4. å¼€å¯å¼‚æ­¥å‘å¸ƒ</h3>
<p>éœ€è¦ä¸¤ä¸ªæ³¨è§£ <code>@EnableAsync</code>å¯åŠ¨AsyncåŠŸèƒ½ , å’Œ <code>@Async</code>æŸä¸ªæ–¹æ³•ä½¿ç”¨å¼‚æ­¥æ‰§è¡Œ</p>
<pre><code class="language-java">å‘å¸ƒäº‹ä»¶æˆåŠŸ , å½“å‰çº¿ç¨‹ : SimpleAsyncTaskExecutor-1
æ¥æ”¶åˆ°æ›´æ–°ä¿¡æ¯ : Config(namespace=application, info={server.port=8088}) , å½“å‰çº¿ç¨‹ : SimpleAsyncTaskExecutor-1
</code></pre>
<p>æˆ‘ä»¬å‘ç°å°±å‡ºç°äº†çº¿ç¨‹æ± æ‰§è¡Œ , è¿™ä¸ªç†çš„çº¿ç¨‹æ±  ,æ˜¯å¯ä»¥è¿›è¡Œé…ç½®çš„ , åªéœ€è¦æˆ‘ä»¬æ˜¾å¼çš„æ³¨å…¥ä¸‹é¢è¿™ä¸ª<code>SimpleAsyncTaskExecutor</code> Bean å°±å¯ä»¥äº†</p>
<pre><code class="language-java">@Bean
public SimpleAsyncTaskExecutor simpleAsyncTaskExecutor() {
    SimpleAsyncTaskExecutor executor = new SimpleAsyncTaskExecutor();
    // éœ€è¦ä¼ å…¥ä¸€ä¸ª ThreadFactoryå®ç°ç±» , æ‰€ä»¥çœ‹è¿‡æˆ‘å‰é¢å†™çš„æ–‡ç« åº”è¯¥ä¼šå†™è¿™ä¸ª,æ¯”å¦‚ JUC- Executoré‚£èŠ‚
    executor.setThreadFactory(new MyThreadFactory(&quot;anthony&quot;));
    return executor;
}
</code></pre>
<p>è¾“å‡ºç»“æœ :</p>
<pre><code class="language-java">å‘å¸ƒäº‹ä»¶æˆåŠŸ , å½“å‰çº¿ç¨‹ : anthony-1
æ¥æ”¶åˆ°æ›´æ–°ä¿¡æ¯ : Config(namespace=application, info={server.port=8088}) , å½“å‰çº¿ç¨‹ : anthony-1
</code></pre>
<h3 id="5-å¤šä¸ªç›‘å¬å™¨é¡ºåºæ‰§è¡Œ">5 . å¤šä¸ªç›‘å¬å™¨é¡ºåºæ‰§è¡Œ</h3>
<p>ä½ å¯ä»¥è·Ÿæˆ‘ä¸€æ ·é€‰æ‹©å®ç° <code>ApplicationListener</code>å’Œ<code>Ordered</code> ,æˆ–è€…ä½ å¯ä»¥ç›´æ¥å®ç° <code>SmartApplicationListener</code>éƒ½ä¸€æ ·çš„å“ˆ,æ²¡æœ‰å“ªä¸ªå¥½å“ªä¸ªä¸å¥½</p>
<p>ç›‘å¬å™¨ ä¸€ :</p>
<pre><code class="language-java">@Component
public class ConfigEventListenerStart implements ApplicationListener&lt;ConfigEvent&gt; , Ordered, InitializingBean {

    @Override
    public void onApplicationEvent(ConfigEvent event) {
        System.out.println(&quot;ConfigEventListenerStart æ¥æ”¶åˆ°æ›´æ–°ä¿¡æ¯ : &quot; + event.getSource()+&quot; , å½“å‰çº¿ç¨‹ : &quot;+Thread.currentThread().getName());
    }

    @Override
    public int getOrder() {
        return Ordered.HIGHEST_PRECEDENCE;
    }


    @Override
    public void afterPropertiesSet() throws Exception {
        System.out.println(&quot;åˆå§‹åŒ–å½“å‰ç›‘å¬å™¨ : &quot; + this.toString());
    }
}
</code></pre>
<p>ç›‘å¬å™¨ äºŒ :</p>
<pre><code class="language-java">@Component
public class ConfigEventListenerEnd implements ApplicationListener&lt;ConfigEvent&gt; , Ordered, InitializingBean {

    @Override
    public void onApplicationEvent(ConfigEvent event) {
        System.out.println(&quot;ConfigEventListenerEnd  æ¥æ”¶åˆ°æ›´æ–°ä¿¡æ¯ : &quot; + event.getSource()+&quot; , å½“å‰çº¿ç¨‹ : &quot;+Thread.currentThread().getName());
    }

    @Override
    public int getOrder() {
        return Ordered.HIGHEST_PRECEDENCE-1;
    }

    @Override
    public void afterPropertiesSet() throws Exception {
        System.out.println(&quot;åˆå§‹åŒ–å½“å‰ç›‘å¬å™¨ : &quot; + this.toString());
    }
}
</code></pre>
<p>è¾“å‡ºç»“æœ :</p>
<pre><code class="language-java">åˆå§‹åŒ–å½“å‰ç›‘å¬å™¨ : com.example.springlistener.listener.ConfigEventListenerEnd@6b54655f
åˆå§‹åŒ–å½“å‰ç›‘å¬å™¨ : com.example.springlistener.listener.ConfigEventListenerStart@665e9289
..... 
å‘å¸ƒäº‹ä»¶æˆåŠŸ , å½“å‰çº¿ç¨‹ : anthony-1
ConfigEventListenerStart æ¥æ”¶åˆ°æ›´æ–°ä¿¡æ¯ : Config(namespace=application, info={server.port=8088}) , å½“å‰çº¿ç¨‹ : anthony-1
ConfigEventListenerEnd  æ¥æ”¶åˆ°æ›´æ–°ä¿¡æ¯ : Config(namespace=application, info={server.port=8088}) , å½“å‰çº¿ç¨‹ : anthony-1    
</code></pre>
<h2 id="5-guava-ä¸­çš„-eventbus">5. Guava ä¸­çš„ EventBus</h2>
<blockquote>
<p>â€‹	Guavaçš„EventBus å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„äº‹ä»¶æ³¨å†Œå‘å¸ƒçš„ç®¡ç†å·¥å…· , ä»–å±äºä¸€ç§æ¨é€çš„æ¨¡å¼ , è·Ÿspringçš„å¾ˆç›¸ä¼¼,</p>
</blockquote>
<h3 id="1-ä¾èµ–">1. ä¾èµ–</h3>
<pre><code class="language-java">&lt;dependency&gt;
    &lt;groupId&gt;com.google.guava&lt;/groupId&gt;
    &lt;artifactId&gt;guava&lt;/artifactId&gt;
    &lt;version&gt;28.0-jre&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="2-å¿«é€Ÿå¼€å§‹">2. å¿«é€Ÿå¼€å§‹</h3>
<blockquote>
<p>â€‹	ä¸»è¦çš„å¯¹è±¡å°±æ˜¯ , <code>EventBus</code> äº‹ä»¶æ€»çº¿, ä»–æ˜¯ç®¡ç†æ‰€æœ‰ç›‘å¬è€…(æˆ–è€…å«åšè®¢é˜…è€…) ,é€šè¿‡<code>EventBus#register</code> æˆ–è€… <code>EventBus#unRegister</code> æ¥ç®¡ç†çš„ ,  åŒæ—¶ç›‘å¬è€…è¦æœ‰ç›‘å¬çš„äº‹ä»¶ , è¿™é‡Œæ˜¯åŸºäºæ–¹æ³•çº§åˆ«çš„ (æ³¨æ„æ–¹æ³•åªèƒ½æœ‰ä¸€ä¸ªå‚æ•°,å°±æ˜¯ç›‘å¬çš„äº‹ä»¶), éœ€è¦åœ¨æ–¹æ³•ä¸ŠåŠ ä¸Š <code>@Subscribe</code> æ³¨è§£æ¥è¡¨ç¤ºç›‘å¬ , <code>EventBus</code>å¯ä»¥é€šè¿‡ <code>EventBus#post</code> æ–¹æ³•æ¥å‘å¸ƒäº‹ä»¶ , å¯¹åº”ç±»å‹çš„ç›‘å¬è€…å°±ä¼šæ”¶åˆ° . åŒæ—¶<code>EventBus</code>å¯ä»¥å¤„ç†å¼‚å¸¸</p>
</blockquote>
<pre><code class="language-java">public class QuicklyStart {

    public static void main(String[] args) {
        // åˆ›å»ºä¸€ä¸ª äº‹ä»¶æ€»çº¿
        EventBus bus = new EventBus(new SubscriberExceptionHandler() {
            @Override
            public void handleException(Throwable exception, SubscriberExceptionContext context) {
                // å¤„ç†è®¢é˜…è€…å¼‚å¸¸ä¿¡æ¯
                System.out.println(&quot;å¼‚å¸¸ä¿¡æ¯ : &quot;+exception.getMessage() + &quot;, å¼‚å¸¸äº‹ä»¶ : &quot; + context.getEvent());
            }
        });

        // æ³¨å†Œä½ çš„ç›‘å¬å™¨ , å…¶å®æ›´åŠ å‡†ç¡®æ¥è¯´æ˜¯è®¢é˜…è€… , ä»–å±äºä¸€ç§å‘å¸ƒè®¢é˜…æ¨¡å¼
        bus.register(new EventListener());

        // äº‹ä»¶æ€»çº¿å‘å¸ƒäº‹ä»¶
        bus.post(&quot;sb&quot;);

        // äº‹ä»¶æ€»çº¿å‘å¸ƒäº‹ä»¶
        bus.post(new Event(&quot;hello Guava&quot;));

    }


}

/**
 * äº‹ä»¶æº
 */
class Event {

    String msg;

    public Event(String msg) {
        this.msg = msg;
    }

    @Override
    public String toString() {
        return &quot;Event{&quot; + &quot;msg='&quot; + msg + '\'' + '}';
    }
}

/**
 * ç›‘å¬å™¨
 */
class EventListener {

    /**
     * {@link Subscribe} ä¸€ä¸ªè¿™ä¸ªä»£è¡¨ä¸€ä¸ªè®¢é˜…è€…,EventBusä¼šå°†ç¬¦åˆçš„äº‹ä»¶å‘å¸ƒåˆ°å¯¹åº”çš„è®¢é˜…è€…ä¸Š , ä½†æ˜¯ä¸æ”¯æŒjavaçš„åŸºæœ¬æ•°æ®ç±»å‹, int ä¹‹ç±»çš„
     *
     * @param event
     */
    @Subscribe
    public void onEvent(Event event) {
        System.out.println(&quot;å½“å‰çº¿ç¨‹ : &quot; + Thread.currentThread().getName() + &quot;, æ¥æ”¶åˆ°äº‹ä»¶ : &quot; + event);
    }


    @Subscribe
    public void onStringEvent(String event) {
        error(); // æ¨¡æ‹Ÿå¼‚å¸¸
        System.out.println(&quot;å½“å‰çº¿ç¨‹ : &quot; + Thread.currentThread().getName() + &quot;, æ¥æ”¶åˆ°äº‹ä»¶ : &quot; + event);
    }

    private void error() {
        int i = 1 / 0;
    }
}
</code></pre>
<p>è¾“å‡º :</p>
<pre><code class="language-java">å¼‚å¸¸ä¿¡æ¯ : / by zero, å¼‚å¸¸äº‹ä»¶ : sb
å½“å‰çº¿ç¨‹ : main, æ¥æ”¶åˆ°äº‹ä»¶ : Event{msg='hello Guava'}
</code></pre>
<h3 id="3-åŸºæœ¬åŸç†">3. åŸºæœ¬åŸç†</h3>
<p>å…¶å®å¾ˆç®€å• , ç¬¬ä¸€æ³¨å†Œçš„æ—¶å€™  :</p>
<pre><code class="language-java">/** Registers all subscriber methods on the given listener object. */
void register(Object listener) {
  // å…¶å®å°±æ˜¯æ³¨è§£æ‰«æ , ç„¶åæŠŠå…ƒä¿¡æ¯éƒ½ç»™æ•´å‡ºæ¥
Multimap&lt;Class&lt;?&gt;, Subscriber&gt; listenerMethods = findAllSubscribers(listener);

for (Entry&lt;Class&lt;?&gt;, Collection&lt;Subscriber&gt;&gt; entry : listenerMethods.asMap().entrySet()) {
  Class&lt;?&gt; eventType = entry.getKey();
  Collection&lt;Subscriber&gt; eventMethodsInListener = entry.getValue();
    // æŸ¥æ‰¾æœ‰æ²¡æœ‰ 
  CopyOnWriteArraySet&lt;Subscriber&gt; eventSubscribers = subscribers.get(eventType);

    // æ²¡æœ‰åˆ›å»ºä¸€ä¸ªå¯¹è±¡
  if (eventSubscribers == null) {
    CopyOnWriteArraySet&lt;Subscriber&gt; newSet = new CopyOnWriteArraySet&lt;&gt;();
    eventSubscribers =
        MoreObjects.firstNonNull(subscribers.putIfAbsent(eventType, newSet), newSet);
  }

    // æ·»åŠ è¿›å» ,å…¶å®æ˜¯ Subscriberå¯¹è±¡ , æŠŠmethodä¿¡æ¯, å¯¹è±¡ä¿¡æ¯å…¨éƒ¨å°è£…è¿›å»äº†
  eventSubscribers.addAll(eventMethodsInListener);
}
}
</code></pre>
<p>ç¬¬äºŒå°±æ˜¯ å‘å¸ƒ</p>
<pre><code class="language-java">  public void post(Object event) {
      // æ ¹æ®äº‹ä»¶è·å–å¯¹åº”çš„ Subscriber
    Iterator&lt;Subscriber&gt; eventSubscribers = subscribers.getSubscribers(event);
    if (eventSubscribers.hasNext()) {
        // å‘å¸ƒå‡ºå»
      dispatcher.dispatch(event, eventSubscribers);
    } else if (!(event instanceof DeadEvent)) {
      // the event had no subscribers and was not itself a DeadEvent
      post(new DeadEvent(this, event));
    }
  }



@Override
void dispatch(Object event, Iterator&lt;Subscriber&gt; subscribers) {
  checkNotNull(event);
  checkNotNull(subscribers);
    // è·å–å½“å‰çº¿ç¨‹çš„é˜Ÿåˆ— ,ç”¨ThreadLocalç»´æŠ¤çš„çº¿ç¨‹å®‰å…¨, å…¶å®æ˜¯ä¸ºäº†å®‰å…¨
  Queue&lt;Event&gt; queueForThread = queue.get();
    // åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¯¹è±¡
  queueForThread.offer(new Event(event, subscribers));

  if (!dispatching.get()) {
    dispatching.set(true);
    try {
      Event nextEvent;
      while ((nextEvent = queueForThread.poll()) != null) {
        while (nextEvent.subscribers.hasNext()) {
            // å¤„ç†
          nextEvent.subscribers.next().dispatchEvent(nextEvent.event);
        }
      }
    } finally {
      dispatching.remove();
      queue.remove();
    }
  }
}


 /** Dispatches {@code event} to this subscriber using the proper executor. */
  final void dispatchEvent(final Object event) {
    executor.execute(
        new Runnable() {
          @Override
          public void run() {
            try {
                // å…³é”®ç‚¹ ,å°±æ˜¯è¿™ 
              invokeSubscriberMethod(event);
            } catch (InvocationTargetException e) {
                // å‡ºç°å¼‚å¸¸ç›´æ¥å°± ... è°ƒç”¨å¼‚å¸¸å›è°ƒæ–¹æ³•äº†
              bus.handleSubscriberException(e.getCause(), context(event));
            }
          }
        });
  }



  @VisibleForTesting
  void invokeSubscriberMethod(Object event) throws InvocationTargetException {
    try {
        // åŸæ¥å¦‚æ­¤ , .........method.invok çœŸ.... æ‰€ä»¥å¯ä»¥æŠ“å–å¼‚å¸¸
      method.invoke(target, checkNotNull(event));
    } catch (IllegalArgumentException e) {
      throw new Error(&quot;Method rejected target/argument: &quot; + event, e);
    } catch (IllegalAccessException e) {
      throw new Error(&quot;Method became inaccessible: &quot; + event, e);
    } catch (InvocationTargetException e) {
      if (e.getCause() instanceof Error) {
        throw (Error) e.getCause();
      }
      throw e;
    }
  }
</code></pre>
<p>æ‰€ä»¥è¿™ä¸ªç©æ„å¾ˆç®€å• , åŸç†ä¸€çœ‹å°±åˆ†æå‡ºæ¥äº†</p>
<h2 id="6-æ€»ç»“">6. æ€»ç»“</h2>
<p>â€‹	æˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„è‡ªå·±å®ç°çš„ç›‘å¬è€…å’Œ <code>Spring</code>å’Œ<code>Guava</code> è¿™ä¿©ç§å®ç°æœ‰å•¥åŒºåˆ« , æ— éå°±æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„ç›‘å¬è€…æ¨¡å¼, å¯¹äº listener çš„ç®¡ç†,æ²¡æœ‰åš , æˆ‘ä»¬åªæ˜¯ä¸€ä¸ª Publisher ä¸€ä¸ª Listener,ä¸€å¯¹ä¸€çš„å…³ç³» , è¿™æ ·å­å°±å¾ˆä¸å¥½, 100ä¸ªç›‘å¬è€…å°±éœ€è¦100ä¸ªå‘å¸ƒè€… , ä¸ç¬¦åˆè®¾è®¡æ¨¡å¼çš„åŸåˆ™ , æ‰€ä»¥å‚è€ƒ<code>Guava</code>,æˆ‘ä»¬å‘ç°ä»–æ— éåšçš„å°±æ˜¯ä¸€ä¸ªå¯¹äºListener çš„ç®¡ç† ,  ä½†æ˜¯æœ‰ä¸€ä¸ªç»†èŠ‚å¸Œæœ›å¤§å®¶çŸ¥é“, å¯¹äºç›‘å¬è€…æ¨¡å¼ , ä¸‡ä¸€äº‹ä»¶å‘å¸ƒå¤±è´¥äº† , æˆ‘ä»¬å¦‚ä½•çŸ¥é“,  æ‰€ä»¥<code>Guava</code> è‡³å°‘å¸®æˆ‘ä»¬åšäº† , ä»–ä¸æ˜¯åŸºäºå›è°ƒæœºåˆ¶çš„, è€Œæ˜¯ä½¿ç”¨äº†<code>Java</code>çš„ <code>Method#invoke</code> ,çœ‹éœ€æ±‚è€Œå®šå§ , åªä¸è¿‡å›è°ƒæ›´åŠ è½»é‡çº§,</p>

								<span id="footnote"></span>
								<div id="warn"></div>
							</div>
							<div class="toc-container"><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#1-java%E5%8E%9F%E7%94%9F%E8%A7%84%E8%8C%83">1. JavaåŸç”Ÿè§„èŒƒ</a>
<ul>
<li><a href="#1-eventobject">1. EventObject</a></li>
<li><a href="#2-eventlistener">2. EventListener</a></li>
<li><a href="#3-%E6%80%BB%E7%BB%93">3. æ€»ç»“</a></li>
</ul>
</li>
<li><a href="#2-java%E8%A7%84%E8%8C%83%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E7%9B%91%E5%90%AC%E8%80%85%E6%A8%A1%E5%BC%8F-%E5%9F%BA%E4%BA%8E%E5%9B%9E%E8%B0%83%E6%A8%A1%E5%BC%8F">2. Javaè§„èŒƒè®¾è®¡ä¸€ä¸ªç›‘å¬è€…æ¨¡å¼ - åŸºäºå›è°ƒæ¨¡å¼</a>
<ul>
<li><a href="#1-%E4%BA%8B%E4%BB%B6%E6%BA%90-eventsource">1. äº‹ä»¶æº - EventSource</a></li>
<li><a href="#2-%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1-eventobject">2. äº‹ä»¶å¯¹è±¡ - EventObject</a></li>
<li><a href="#3-%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E8%80%85-eventlistener">3. äº‹ä»¶ç›‘å¬è€… - EventListener</a></li>
<li><a href="#4-%E4%BA%8B%E4%BB%B6%E5%8F%91%E5%B8%83%E8%80%85-eventpublisher">4. äº‹ä»¶å‘å¸ƒè€… -  EventPublisher</a></li>
<li><a href="#5-%E6%B5%8B%E8%AF%95demo">5. æµ‹è¯•Demo</a></li>
</ul>
</li>
<li><a href="#3-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98">3. å›è°ƒå‡½æ•°å­˜åœ¨çš„é—®é¢˜ ?</a>
<ul>
<li><a href="#1-%E6%88%91%E4%BB%AC%E7%9A%84%E9%97%AE%E9%A2%98">1. æˆ‘ä»¬çš„é—®é¢˜ ?</a></li>
<li><a href="#2-%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98">2. è§£å†³é—®é¢˜</a></li>
</ul>
</li>
<li><a href="#4-spring-%E4%B8%AD%E7%9A%84-applicationlistener">4. Spring ä¸­çš„ ApplicationListener</a>
<ul>
<li><a href="#1-applicationevent">1. ApplicationEvent</a></li>
<li><a href="#2-applicationlistener">2. ApplicationListener</a></li>
<li><a href="#3-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8">3. å¼€å§‹ä½¿ç”¨</a>
<ul>
<li><a href="#1-config-%E4%BA%8B%E4%BB%B6%E6%BA%90">1. Config - äº‹ä»¶æº</a></li>
<li><a href="#2-configevent-%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1">2. ConfigEvent - äº‹ä»¶å¯¹è±¡</a></li>
<li><a href="#3-configeventlistener-%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E8%80%85">3. ConfigEventListener - äº‹ä»¶ç›‘å¬è€…</a></li>
<li><a href="#5-configserver-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E6%9C%8D%E5%8A%A1">5 . ConfigServer - é…ç½®ä¸­å¿ƒæœåŠ¡</a></li>
<li><a href="#6-%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95">6. å¯åŠ¨æµ‹è¯•</a></li>
</ul>
</li>
<li><a href="#4-%E5%BC%80%E5%90%AF%E5%BC%82%E6%AD%A5%E5%8F%91%E5%B8%83">4. å¼€å¯å¼‚æ­¥å‘å¸ƒ</a></li>
<li><a href="#5-%E5%A4%9A%E4%B8%AA%E7%9B%91%E5%90%AC%E5%99%A8%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C">5 . å¤šä¸ªç›‘å¬å™¨é¡ºåºæ‰§è¡Œ</a></li>
</ul>
</li>
<li><a href="#5-guava-%E4%B8%AD%E7%9A%84-eventbus">5. Guava ä¸­çš„ EventBus</a>
<ul>
<li><a href="#1-%E4%BE%9D%E8%B5%96">1. ä¾èµ–</a></li>
<li><a href="#2-%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B">2. å¿«é€Ÿå¼€å§‹</a></li>
<li><a href="#3-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86">3. åŸºæœ¬åŸç†</a></li>
</ul>
</li>
<li><a href="#6-%E6%80%BB%E7%BB%93">6. æ€»ç»“</a></li>
</ul>
</li>
</ul>
</div>
						</div>
						<div id="fullPage"><canvas id="canvas"></canvas></div>
				</article>
				<div id="eof"><span>EOF</span></div>
				<div class="round-shape-one"></div>
				<section>
					<div class="doc_comments">
							<div id="valine-container"></div>
					</div>
				</section>
			</div>
		</div>
	</div>
	<script>
		"use strict";
		! function () {
			for (var n = document.getElementsByTagName("pre"), e = n.length, s = 0; s < e; s++) {
				n[s].innerHTML = '<span class="line-number"></span>' + n[s].innerHTML + '<span class="cl"></span>';
				for (var a = n[s].innerHTML.split(/\n/).length, r = 0; r < a - 1; r++) {
					n[s].getElementsByTagName("span")[0].innerHTML += "<span>" + (r + 1) + "</span>"
				}
			}
		}();
		let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");
		window.addEventListener("scroll", event => {
			let fromTop = window.scrollY;
			mainNavLinks.forEach((link, index) => {
				let section = document.getElementById(decodeURI(link.hash).substring(1));
				let nextSection = null
				if (mainNavLinks[index + 1]) {
					nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(
						1));
				}
				if (section.offsetTop <= fromTop) {
					if (nextSection) {
						if (nextSection.offsetTop > fromTop) {
							link.classList.add("currentToc");
						} else {
							link.classList.remove("currentToc");
						}
					} else {
						link.classList.add("currentToc");
					}
				} else {
					link.classList.remove("currentToc");
				}
			});
		});
		var list = document.querySelectorAll(".katex");
		for (var i = 0; i < list.length; i++) {
			list[i].style.display = "unset"
		};
		var h = document.documentElement,
			b = document.body,
			st = "scrollTop",
			sh = "scrollHeight",
			progress = document.querySelector(".progress"),
			scroll;
		document.addEventListener("scroll", function () {
			scroll = (h[st] || b[st]) / ((h[sh] || b[sh]) - h.clientHeight) * 100;
			progress.style.setProperty("--scroll", scroll + "%")
		});
		var wxScale = new WxScale({
			fullPage: document.querySelector("#fullPage"),
			canvas: document.querySelector("#canvas")
		});
		var imgBox = document.querySelectorAll("#md_block img");
		for (var i = 0; i < imgBox.length; i++) {
			imgBox[i].onclick = function (e) {
				wxScale.start(this)
			}
		};
	</script>
	<style>
		#magnifyImg {
			position: fixed;
			left: 0;
			top: 0;
			text-align: center;
			width: 100%;
			display: none;
			z-index: 9999
		}

		#magnifyImg img {
			object-fit: contain;
			background: #eaecef;
			padding: 15px;
			border-radius: 10px;
			height: auto;
			width: auto;
			vertical-align: middle
		}
	</style>
	<a id="scrollUp"href="#top"style="position: fixed; z-index: 2147483647; display: block;"></a><div class="footer animated fadeInDown"><div class="site_footer"><div class="mysocials"><div class="my_socials"><a href="https://github.com/Anthony-Dong"title="github"><i class="iconfont icon-github"></i></a><a href="fanhaodong516@gmail.com"title="envelope"><i class="iconfont icon-envelope"></i></a></div></div><div class="copyright"id="copyright">You Are My Everything. <a href="mailto:574986060@qq.com" target="blank">Send Email</a>CopyrightÂ©2018-2020<a href="https://anthony-dong.github.io"style="margin:0;">Serence</a>.</div><span style="display: inline;margin-right:15px;">ğŸ‘<strong><span id="count-page">168271</span></strong></span><span id="busuanzi_container_page_pv"style="display: inline;"><span>ğŸ“š<strong>186</strong>posts</span></div></div><script>console.log("\n %c \u26a1Anthony-Dong's Blog:https://anthony-dong.gitee.io ,Github:https://github.com/Anthony-Dong ,Email:574986060@qq.com ,æœ‰äº‹æƒ…æ¬¢è¿è”ç³». \n\n","color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;",);</script>
	<script type="text/javascript" async src="https://anthony-dong.github.io/media/js/prism.js"></script>
</body>
</html>